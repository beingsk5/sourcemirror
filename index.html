<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SourceMirror</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-zinc-950 text-zinc-100">

<div class="max-w-3xl mx-auto p-6">

  <h1 class="text-3xl font-semibold mb-2">SourceMirror</h1>
  <p class="text-zinc-400 mb-6">
    Public job based mirroring to SourceForge
  </p>

  <!-- ===========================
       Links editor
       =========================== -->

  <div id="linksArea" class="space-y-4"></div>

  <button
    id="addLinkBtn"
    class="mt-3 text-sm text-blue-400 hover:text-blue-300"
    type="button"
  >
    + Add link
  </button>

  <!-- ===========================
       Global notes
       =========================== -->

  <div class="mt-6">
    <label class="block text-sm text-zinc-400 mb-1">
      Job notes (optional)
    </label>
    <textarea
      id="jobNotes"
      placeholder="Anything you want to remember about this job…"
      class="w-full h-20 p-3 rounded-lg bg-zinc-900 border border-zinc-800 resize-none focus:outline-none"
    ></textarea>
  </div>

  <!-- ===========================
       Start
       =========================== -->

  <button
    id="startBtn"
    class="mt-6 px-5 py-2 rounded-lg bg-blue-600 hover:bg-blue-500 font-medium
           disabled:opacity-60 disabled:cursor-not-allowed"
  >
    Start mirroring
  </button>

  <!-- ===========================
       Job box
       =========================== -->

  <div id="jobBox" class="hidden mt-10">
    <div class="bg-zinc-900 border border-zinc-800 rounded-xl p-5">

      <div class="flex items-center justify-between mb-4">
        <div>
          <div class="text-sm text-zinc-400">Job</div>
          <div id="jobId" class="font-mono text-sm break-all"></div>
        </div>
      </div>

      <div id="filesArea" class="space-y-4"></div>

      <div class="mt-4 text-sm text-zinc-400">
        Status:
        <span id="jobStatus">Queued</span>
      </div>

    </div>
  </div>

</div>

<script>
/* =========================================================
   Link card UI builder
   ========================================================= */

const linksArea  = document.getElementById("linksArea");
const addLinkBtn = document.getElementById("addLinkBtn");

let linkCounter = 0;

function createLinkCard() {

  linkCounter++;

  const wrapper = document.createElement("div");
  wrapper.className =
    "border border-zinc-800 rounded-xl p-4 bg-zinc-900";

  wrapper.innerHTML = `
    <div class="flex items-center justify-between">
      <div class="font-medium">Link ${linkCounter}</div>
      <button type="button" class="text-xs text-red-400 hover:text-red-300 removeBtn">
        Remove
      </button>
    </div>

    <div class="mt-3">
      <input
        type="text"
        placeholder="https://example.com/file.zip"
        class="urlInput w-full p-2 rounded-md bg-zinc-800 border border-zinc-700 focus:outline-none"
      >
    </div>

    <button type="button"
      class="mt-3 text-sm text-zinc-400 hover:text-zinc-200 toggleBtn">
      ▸ Advanced
    </button>

    <div class="advanced hidden mt-3 space-y-3">

      <div>
        <label class="block text-xs text-zinc-400 mb-1">
          Folder name (optional)
        </label>
        <input
          type="text"
          class="folderInput w-full p-2 rounded-md bg-zinc-800 border border-zinc-700 focus:outline-none"
          placeholder="example-folder"
        >
      </div>

      <div>
        <label class="block text-xs text-zinc-400 mb-1">
          Rename file (without extension)
        </label>
        <input
          type="text"
          class="renameInput w-full p-2 rounded-md bg-zinc-800 border border-zinc-700 focus:outline-none"
          placeholder="new-file-name"
        >
      </div>

      <div class="flex items-center gap-2">
        <input type="checkbox" class="allowExtChk accent-blue-500">
        <label class="text-xs text-zinc-400">
          Allow extension change
        </label>
      </div>

      <div>
        <label class="block text-xs text-zinc-400 mb-1">
          Notes (per link)
        </label>
        <textarea
          class="notesInput w-full p-2 rounded-md bg-zinc-800 border border-zinc-700 resize-none focus:outline-none"
          rows="2"
        ></textarea>
      </div>

    </div>
  `;

  const toggleBtn = wrapper.querySelector(".toggleBtn");
  const advanced  = wrapper.querySelector(".advanced");
  const removeBtn = wrapper.querySelector(".removeBtn");

  toggleBtn.onclick = () => {
    const open = !advanced.classList.contains("hidden");
    advanced.classList.toggle("hidden", open);
    toggleBtn.textContent = open ? "▸ Advanced" : "▾ Advanced";
  };

  removeBtn.onclick = () => {
    wrapper.remove();
  };

  return wrapper;
}

addLinkBtn.onclick = () => {
  linksArea.appendChild(createLinkCard());
};

// add first link by default
linksArea.appendChild(createLinkCard());
</script>

<script src="app.js"></script>
</body>
</html>
